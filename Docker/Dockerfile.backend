FROM golang:1.22.2

WORKDIR /app

ARG HTTP_LISTEN_ADDRESS
ARG MONGO_DB_NAME
ARG MONGO_DB_URL
ARG JWT_SECRET

ENV HTTP_LISTEN_ADDRESS ${HTTP_LISTEN_ADDRESS}
ENV MONGO_DB_NAME ${MONGO_DB_NAME}
ENV MONGO_DB_URL ${MONGO_DB_URL}
ENV JWT_SECRET ${JWT_SECRET}

COPY go.mod go.sum ./
RUN go mod download
COPY . .

EXPOSE 8000
ENTRYPOINT ["make", "run"]